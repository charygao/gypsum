APIELEMENTS_SRC_DIR := $(realpath $(dir $(lastword $(MAKEFILE_LIST))))

APIELEMENTS_PROGRAM := $(OUT_DIR)/ApiElements
TEST_PROGRAMS += $(APIELEMENTS_PROGRAM)
APIELEMENTS_SOURCES := $(APIELEMENTS_SRC_DIR)/ApiElements.cpp
APIELEMENTS_OBJECTS := $(call objects,$(APIELEMENTS_SOURCES))

APIELEMENTS_PACKAGES := $(OUT_DIR)/ApiElements-1.csp
APIELEMENTS_GY_SOURCES := $(APIELEMENTS_SRC_DIR)/ApiElements.gy

TEST_PROGRAM_SOURCES += $(APIELEMENTS_SOURCES)
TEST_PROGRAM_OBJECTS += $(APIELEMENTS_OBJECTS)

$(APIELEMENTS_PROGRAM): $(APIELEMENTS_OBJECTS) $(LIB) $(APIELEMENTS_PACKAGES)

$(OUT_DIR)/ApiElements-1.csp: $(APIELEMENTS_GY_SOURCES) $(STD_PACKAGE)
	@mkdir -p $(dir $@)
	$(GY_COMPILE) -p ApiElements -v 1 $< -o $@

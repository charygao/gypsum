APIBYNAME_SRC_DIR := $(realpath $(dir $(lastword $(MAKEFILE_LIST))))

APIBYNAME_PROGRAM := $(OUT_DIR)/ApiByName
TEST_PROGRAMS += $(APIBYNAME_PROGRAM)
APIBYNAME_SOURCES := $(APIBYNAME_SRC_DIR)/ApiByName.cpp
APIBYNAME_OBJECTS := $(call objects,$(APIBYNAME_SOURCES))

APIBYNAME_PACKAGES := $(OUT_DIR)/ApiByName-1.csp
APIBYNAME_GY_SOURCES := $(APIBYNAME_SRC_DIR)/ApiByName.gy

TEST_PROGRAM_SOURCES += $(APIBYNAME_SOURCES)
TEST_PROGRAM_OBJECTS += $(APIBYNAME_OBJECTS)

$(APIBYNAME_PROGRAM): $(APIBYNAME_OBJECTS) $(LIB) $(APIBYNAME_PACKAGES)

$(OUT_DIR)/ApiByName-1.csp: $(APIBYNAME_GY_SOURCES) $(STD_PACKAGE)
	@mkdir -p $(dir $@)
	$(GY_COMPILE) -p ApiByName -v 1 $< -o $@
